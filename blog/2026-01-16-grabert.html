<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Grabert-Mori-Zwanzig and the Jarzynski equality – Francesco Caravelli</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Inter:wght@300;500;700&display=swap" rel="stylesheet">

  <!-- Optional: nice spacing for display-math blocks -->
  <style>
    p.math { margin: 1rem 0; }
  </style>

  <!-- AdSense: load ONCE per page -->
  <script async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6719988103594554"
    crossorigin="anonymous"></script>

  <!-- KaTeX (fast TeX rendering) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>

  <script defer>
    function renderKatexIn(el) {
      if (!el || typeof renderMathInElement !== "function") return;
      renderMathInElement(el, {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "\\[", right: "\\]", display: true },
          { left: "$", right: "$", display: false },
          { left: "\\(", right: "\\)", display: false }
        ],
        throwOnError: false,
        // Helps if you use \mathbbm{1} somewhere; KaTeX doesn't ship bbm by default
        macros: {
          "\\mathbbm": "\\mathbb"
        },
        ignoredTags: ["script", "noscript", "style", "textarea", "pre", "code"]
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      renderKatexIn(document.querySelector("main.content"));
    });
  </script>
</head>

<body>
  <div class="layout">
    <!-- Sidebar -->
    <div id="sidebar"></div>

    <main class="content">

      <!-- In-article AdSense Ad -->
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-format="fluid"
           data-ad-layout-key="-ef+6k-30-ac+ty"
           data-ad-client="ca-pub-6719988103594554"
           data-ad-slot="9710109684"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      <h2>(Grabert-)Mori-Zwanzig and the Jarzynski equality - Francesco Caravelli</h2>

      January 16, 2026<br/><br/>

      <p>
        For some time now I've been working on a side project (which as many are now in my Overleaf) which involves fluctuation theorems and the Mori-Zwanzig approach
        to coarse graining. Today I'd like to discuss a bit about the connection between the two, which I find quite fascinating.
        The Mori-Zwanzig formalism is a powerful technique in statistical mechanics that allows us to derive
        effective equations of motion for a subset of variables in a complex system by
        integrating out the remaining degrees of freedom.
        This is particularly useful when dealing with systems that have a large number of interacting components,
        as it enables us to focus on the relevant variables while still accounting for the influence of the others via noise and memory.
        The derivation is not too hard. I will actually give it here in two different ways, and then I will focus on the Grabert approach to MZ.
        What I want to show is that the JE can be derived in a few lines from that.
      </p>

      <section id="grabert-relevant-distribution-projectors">

        <h2>Grabert’s “relevant” distribution and projectors (classical version)</h2>

        <p>
          Let’s start with a classical Hamiltonian system. A microstate lives in phase space
          $\Gamma=(\mathbf q,\mathbf p)$, and the Hamiltonian may depend on time, $H(\Gamma,t)$.
          Microscopic dynamics is Hamiltonian flow:
        </p>

        <p class="math" id="eq-flow">
        \[
          \Gamma_t = \Phi_t(\Gamma_0).
        \]
        </p>

        <p>This flow is generated by the (time-dependent) Liouville operator</p>

        <p class="math" id="eq-liouville">
        \[
          iL(t)\,X(\Gamma)=\{X(\Gamma),H(\Gamma,t)\}.
        \]
        </p>

        <p>
          where $\{\cdot,\cdot\}$ is the classical Poisson bracket. One detail that will play a central role later
          (Jarzynski, and also the relations we’ll derive in the same spirit) is that Hamiltonian evolution preserves
          phase-space volume: $d\Gamma_t=d\Gamma_0$.
        </p>

        <h3>Picking what you care about: relevant observables</h3>

        <p>
          A coarse-grained description starts by deciding which macroscopic observables you want to track. In Grabert’s
          setup you choose a set of “relevant” observables
          $\{A_1(\Gamma),\dots,A_n(\Gamma)\}$ and you record their instantaneous macroscopic values as expectations under
          the <em>true</em> microscopic distribution $\rho(\Gamma,t)$:
        </p>

        <p class="math" id="eq-ai-def">
        \[
          a_i(t)=\int d\Gamma\,\rho(\Gamma,t)\,A_i(\Gamma).
        \]
        </p>

        <p>
          The point is: if the only information you keep at time $t$ is the set of numbers $\{a_i(t)\}$, then everything
          else about the full microstate distribution is “unknown” from the coarse-grained viewpoint.
        </p>

        <h3>The maximum-entropy guess: Grabert’s relevant distribution</h3>

        <p>
          Grabert’s prescription is to build the statistical state that best represents the system given only those
          constraints: maximize Shannon entropy subject to the conditions above. The result is the familiar exponential
          family
        </p>

        <p class="math" id="eq-exponential0">
        \[
          \bar\rho(\Gamma,t)
          =
          \frac{1}{Z(t)}
          \exp\!\left[-\lambda_i(t)\,A_i(\Gamma)\right].
        \]
        </p>

        <p>
          where the $\lambda_i(t)$ are Lagrange multipliers enforcing the constraints, and $Z(t)$ normalizes the density:
        </p>

        <p class="math" id="eq-Z">
        \[
          Z(t)=\int d\Gamma\,\exp\!\left[-\lambda_i(t)\,A_i(\Gamma)\right].
        \]
        </p>

        <p>
          In Grabert’s approach, the non-equilibrium entropy associated with this relevant distribution is just the
          Shannon entropy:
        </p>

        <p class="math" id="eq-Shannon">
        \[
          S(t)
          =
          -k_B\int d\Gamma\,\bar\rho(\Gamma,t)\,\ln\bar\rho(\Gamma,t).
        \]
        </p>

        <p>For the exponential family above, you get the key thermodynamic identities</p>

        <p class="math" id="eq-entropy-identity">
        \[
          \frac{S(t)}{k_B}
          =
          \ln Z(t) + \lambda_i(t)\,a_i(t),
          \qquad
          \lambda_i(t)=\frac{1}{k_B}\frac{\partial S}{\partial a_i(t)}.
        \]
        </p>

        <p>
          These are telling you something important: the multipliers $\lambda_i(t)$ behave as generalized thermodynamic
          conjugates to the macroscopic variables $a_i(t)$.
        </p>

        <h3>The key operator: a time-dependent projector on observables</h3>

        <p>
          The second ingredient is a <em>time-dependent projection operator</em> $P(t)$ acting on observables (i.e. functions
          of phase space). Intuitively, $P(t)$ extracts the part of any observable $X(\Gamma)$ that is fixed once you know
          the relevant variables and their fluctuations at time $t$.
        </p>

        <p class="math" id="eq-projector-def">
        \[
          P(t)X
          =
          \langle X\rangle_{\mathrm{rel},t}
          +
          \bigl(A_j(\Gamma)-a_j(t)\bigr)
          \int d\Gamma'\,
          \frac{\partial \bar\rho(\Gamma',t)}{\partial a_j(t)}\,
          X(\Gamma').
        \]
        </p>

        <p>where Grabert’s relevant average is</p>

        <p class="math" id="eq-rel-avg">
        \[
          \langle X\rangle_{\mathrm{rel},t}
          =
          \int d\Gamma\,\bar\rho(\Gamma,t)\,X(\Gamma).
        \]
        </p>

        <p>This projector satisfies a generalized idempotency property</p>

        <p class="math" id="eq-P-idempotency">
        \[
          P(t)\,P(t')=P(t').
        \]
        </p>

        <p>
          The complementary projector is $Q(t)=\mathbb{1}-P(t)$, and it extracts what’s “irrelevant”:
          $Q(t)X=X-P(t)X$. So every observable decomposes as $X=P(t)X+Q(t)X$.
        </p>

        <h3>Projectors on densities: the dual picture</h3>

        <p>The bridge is the natural pairing between a density $\rho(\Gamma)$ and an observable $X(\Gamma)$:</p>

        <p class="math" id="eq-pairing">
        \[
          \langle \rho, X\rangle
          =
          \int d\Gamma\,\rho(\Gamma)\,X(\Gamma).
        \]
        </p>

        <p>The dual projector $P^\dagger(t)$ is defined so that</p>

        <p class="math" id="eq-dual-projector-def">
        \[
          \langle P^\dagger(t)\rho,\;X\rangle
          =
          \langle \rho,\;P(t)X\rangle
          \qquad\text{for all densities $\rho$ and observables $X$.}
        \]
        </p>

        <p>If $\rho(\Gamma,t)$ is the true microscopic density, the dual projector extracts its relevant part:</p>

        <p class="math" id="eq-rho-rel">
        \[
          \rho_{\mathrm{rel}}(\Gamma,t)\equiv P^\dagger(t)\rho(\Gamma,t).
        \]
        </p>

        <p>And $\bar\rho(\Gamma,t)$ is a fixed point of the dual projector:</p>

        <p class="math" id="eq-fixed-point-dual">
        \[
          P^\dagger(t)\,\bar\rho(\Gamma,t)=\bar\rho(\Gamma,t).
        \]
        </p>

        <p>
          The complementary dual projector is $Q^\dagger(t)=\mathbb{1}-P^\dagger(t)$, so
          $Q^\dagger(t)\rho=\rho-P^\dagger(t)\rho$.
        </p>

      </section>

      <div style="max-width: 720px; margin: 1.25rem 0;">
        <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 10px;">
          <iframe
            src="https://www.youtube.com/embed/zZ2NmjUdRYg"
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
          </iframe>
        </div>
      </div>

      <!-- Second ad block (NO second AdSense script include) -->
      <ins class="adsbygoogle"
           style="display:block; text-align:center;"
           data-ad-layout="in-article"
           data-ad-format="fluid"
           data-ad-client="ca-pub-6719988103594554"
           data-ad-slot="2406334732"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      <p><a href="../blog.html">← Back to Blog</a></p>

    </main>
  </div>

  <script>
    async function loadSidebar() {
      const sidebarContainer = document.getElementById('sidebar');
      const response = await fetch('../partials/sidebar.html');
      const html = await response.text();
      sidebarContainer.innerHTML = html;

      const currentPath = window.location.pathname.split('/').pop();
      const links = sidebarContainer.querySelectorAll('a');
      links.forEach(link => {
        if (link.getAttribute('href') === currentPath) {
          link.classList.add('active');
        }
      });

      // Re-render KaTeX in case the injected sidebar contains math
      if (typeof renderMathInElement === "function") {
        renderMathInElement(document.querySelector("main.content"), {
          delimiters: [
            { left: "$$", right: "$$", display: true },
            { left: "\\[", right: "\\]", display: true },
            { left: "$", right: "$", display: false },
            { left: "\\(", right: "\\)", display: false }
          ],
          throwOnError: false,
          macros: { "\\mathbbm": "\\mathbb" },
          ignoredTags: ["script", "noscript", "style", "textarea", "pre", "code"]
        });
      }
    }
    loadSidebar();
  </script>
</body>
</html>
